
# Прогнозирование стоимости автомобилей

## Что было сделано

В рамках данного проекта была реализована модель машинного обучения для прогнозирования стоимости автомобилей на основе различных характеристик, таких как год выпуска, пробег, тип топлива, тип продавца и другие. Задача заключалась в разработке сервиса для предсказания стоимости автомобиля по заданным признакам, а также в создании модели, которая будет использоваться для инференса.

### Шаги, предпринятые для реализации:

1. **Обработка данных**:
   - Я использовал набор данных о продажах автомобилей, включающий такие характеристики, как модель, год, пробег, топливо, передача и другие.
   - Данные были очищены от пропусков и аномалий. Для числовых признаков использовались медианные значения для заполнения пропусков, а для категориальных признаков применялись наиболее часто встречающиеся значения.
   - Преобразованы столбцы, такие как `mileage`, `engine` и `max_power`, для извлечения числовых значений из строк (например, из "15 kmpl" было извлечено значение 15).

2. **Моделирование**:
   - Для прогнозирования стоимости автомобиля была выбрана модель **линейной регрессии**, так как она показала хорошие результаты при анализе зависимости стоимости от признаков.
   - Модель была обучена на подготовленных данных, после чего были сохранены её веса в файл `.pickle` для дальнейшего использования в API.

3. **Разработка API**:
   - На основе **FastAPI** был разработан сервис, который принимает данные о машине (в формате JSON), выполняет их предсказание с помощью обученной модели и возвращает результат в виде предсказанной стоимости.
   - Были реализованы два метода API:
     - `/predict_item`: для предсказания стоимости одного автомобиля по его признакам.
     - `/predict_items`: для предсказания стоимости множества автомобилей за один запрос.

4. **Модели и сохранение веса**:
   - Модель была сохранена в формате `.pickle` для использования в продакшн-среде.

5. **Сохранение дашборда**:
   - В процессе работы был создан дашборд для визуализации различных метрик модели, таких как ошибки, корреляции между признаками и другие статистики. Этот дашборд был сохранён в виде HTML-файла.

---

## Результаты

### Итоговая модель

- Модель линейной регрессии показала достаточно хорошую точность на тестовых данных. Несмотря на то, что она не является самой сложной моделью, её результаты для данной задачи удовлетворительные.

### Что дало наибольший буст в качестве:

- **Преобразование категориальных признаков в числовые значения**: Преобразование таких признаков, как `fuel`, `seller_type`, `transmission` в числовые значения (через кодирование или замены на медиану) значительно улучшило качество модели.
- **Предобработка данных**: Заполнение пропусков с использованием медианных значений и удаление дубликатов улучшили результаты модели и позволили избежать переобучения.

### Проблемы и ограничения

- **Отсутствие более сложных моделей**: Мы использовали линейную регрессию, так как это простая модель для задачи. Однако, более сложные модели, такие как случайный лес или градиентный бустинг, могли бы дать лучшее качество предсказания.
- **Ограничения по данным**: Размер и разнообразие данных были ограничены, что могло повлиять на качество модели. Модели, обученные на более крупных и разнообразных наборах данных, могли бы давать более точные результаты.

---

## Структура репозитория

- **notebook.ipynb**: Jupyter Notebook с проведёнными экспериментами и визуализациями.
- **model.py**: Python-файл с реализацией сервиса и методов API.
- **car_price_model.pkl**: Сохранённая модель линейной регрессии, готовая для инференса.
- **README.md**: Этот файл с выводами по проделанной работе.

---

## Заключение

Проект продемонстрировал успешную реализацию модели машинного обучения для предсказания стоимости автомобилей. Были учтены важные аспекты, такие как очистка данных, преобразование категориальных признаков и выбор модели. В дальнейшем проект можно улучшить за счёт использования более сложных моделей и расширения набора данных.

